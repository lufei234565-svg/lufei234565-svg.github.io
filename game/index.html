<!DOCTYPE html>
<html lang="zh" data-theme="">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ä»£ç æ¢é™©å²› Â· å‡çº§ç‰ˆ L1â€“L10</title>
<style>
  /* ä¸»é¢˜å˜é‡ï¼šé»˜è®¤ï¼ˆè“ï¼‰ */
  :root{
    --pri:#0d6efd; --pri-hover:#0b5ed7;
    --danger:#dc3545; --danger-hover:#bb2d3b;
    --bg:#f5f7fb; --panel:#fff; --border:#e5e7eb; --text:#111;
  }
  /* ç»¿è‰² */
  html[data-theme="green"]{
    --pri:#22c55e; --pri-hover:#16a34a;
    --danger:#ef4444; --danger-hover:#dc2626;
    --bg:#f0fdf4; --panel:#ffffff; --border:#d1fae5; --text:#0b0f10;
  }
  /* é»‘é‡‘ï¼ˆæ·±è‰²ï¼‰ */
  html[data-theme="blackgold"]{
    --pri:#d4af37; --pri-hover:#b8860b;
    --danger:#ff4d4f; --danger-hover:#d9363e;
    --bg:#0f0f0f; --panel:#151515; --border:#2a2a2a; --text:#f5f5f5;
  }

  *{box-sizing:border-box}
  body{margin:0;font-family:"Microsoft YaHei",sans-serif;background:var(--bg); color:var(--text)}
  header{background:var(--pri);color:#fff;padding:16px;text-align:center}
  .top-buttons{ position:fixed; top:12px; right:16px; display:flex; gap:10px; z-index:999; }
  .toolbar{ position:fixed; left:16px; top:12px; z-index:999; display:flex; gap:8px; align-items:center; background:color-mix(in srgb, var(--panel) 85%, transparent); padding:6px 10px; border-radius:8px; border:1px solid var(--border); }
  select{ padding:6px 8px; border-radius:8px; border:1px solid var(--border); background:var(--panel); color:var(--text); }

  .wrap{max-width:1100px;margin:0 auto;padding:12px;display:grid;grid-template-columns:260px 1fr;gap:12px}
  .sidebar{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:10px;height:calc(100vh - 160px);overflow:auto}
  .lvl{padding:10px 12px;border:1px solid var(--border);border-radius:10px;margin-bottom:8px;cursor:pointer;background:var(--panel)}
  .lvl:hover{background:color-mix(in srgb, var(--pri) 10%, var(--panel))}
  .active{outline:2px solid var(--pri)}
  .stage{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:16px;min-height:560px;display:flex;flex-direction:column}
  .topbar{display:flex;align-items:center;gap:10px;margin-bottom:12px}
  .btn{
    border:1px solid var(--border); background:var(--pri); color:#fff;
    border-radius:999px; padding:8px 14px; font-size:14px; text-decoration:none; cursor:pointer;
    box-shadow:0 4px 10px color-mix(in srgb, var(--pri) 35%, transparent); transition:.2s;
  }
  .btn:hover{ background:var(--pri-hover) }
  .btn.danger{ background:var(--danger) }
  .btn.danger:hover{ background:var(--danger-hover) }
  .scene{flex:1;border:1px dashed var(--border);border-radius:12px;display:flex;align-items:center;justify-content:center;background:color-mix(in srgb, var(--panel) 85%, var(--bg));position:relative;overflow:hidden}
  .tag{margin-top:8px;color:#667085}
  .result{margin-top:8px;font-weight:bold}
  .next-btn{display:none;margin-top:10px}
  .next-btn.show{display:inline-block}
  .footer{text-align:center;padding:16px;font-size:.9rem;color:#666}
  .footer a{color:var(--pri);text-decoration:none}
  .footer a:hover{text-decoration:underline}
</style>
</head>
<body>

  <!-- å·¦ä¸Šï¼šä¸»é¢˜é€‰æ‹©å™¨ -->
  <div class="toolbar">
    <label for="theme">ğŸ¨ ä¸»é¢˜ï¼š</label>
    <select id="theme">
      <option value="">è“è‰²</option>
      <option value="green">ç»¿è‰²</option>
      <option value="blackgold">é»‘é‡‘</option>
    </select>
  </div>

  <!-- å³ä¸Šï¼šè¿”å› & é‡æ–°å¼€å§‹ -->
  <div class="top-buttons">
    <a href="../" class="btn">ğŸ  è¿”å›é¦–é¡µ</a>
    <button id="resetProgress" class="btn danger">ğŸ”„ é‡æ–°å¼€å§‹</button>
  </div>

  <header><h1>ğŸ ä»£ç æ¢é™©å²› Â· å‡çº§ç‰ˆ L1â€“L10</h1></header>

  <div class="wrap">
    <aside class="sidebar" id="menu"></aside>

    <section class="stage">
      <div class="topbar">
        <button class="btn" id="run">â–¶ è¿è¡Œ</button>
        <button class="btn" id="reset">â†© é‡ç½®</button>
        <span id="hint">è¯·é€‰æ‹©å·¦ä¾§å…³å¡</span>
      </div>
      <div class="scene" id="scene"></div>
      <div class="tag" id="desc"></div>
      <div class="result" id="result"></div>
      <button class="btn next-btn" id="nextBtn">â¡ ä¸‹ä¸€å…³</button>
    </section>
  </div>

  <div class="footer">
    <a href="../">â† è¿”å›é¦–é¡µ</a>
  </div>

  <audio id="bgm" loop></audio>

<script>
/* ===== ä¸»é¢˜åŒæ­¥ ===== */
const themeSel = document.getElementById('theme');
const savedTheme = localStorage.getItem('siteTheme') || '';
document.documentElement.setAttribute('data-theme', savedTheme);
themeSel.value = savedTheme;
themeSel.onchange = () => {
  document.documentElement.setAttribute('data-theme', themeSel.value);
  localStorage.setItem('siteTheme', themeSel.value);
};

/* ===== å…¬å…±å¼•ç”¨ ===== */
const scene=document.getElementById("scene");
const desc=document.getElementById("desc");
const hint=document.getElementById("hint");
const result=document.getElementById("result");
const nextBtn=document.getElementById("nextBtn");
const bgm=document.getElementById("bgm");
let current=null;

function setResult(msg,ok=false){
  result.textContent=msg||"";
  nextBtn.classList.toggle("show",!!ok);
}
function playMusic(url){ bgm.src=url; bgm.play().catch(()=>{}); }
function saveProgress(levelId){
  const levelNum=Number(levelId.replace("L",""));
  const passed=Number(localStorage.getItem("passedLevels")||0);
  localStorage.setItem("passedLevels",Math.max(passed,levelNum));
}

/* ===== å…³å¡ï¼ˆç®€åŒ–æ¼”ç¤ºé€»è¾‘ï¼ŒåŒå‰ä¸€ç‰ˆï¼‰ ===== */
const LEVELS={
  L1:{title:"L1 ç‚¹äº®ç«æŠŠ ğŸ”¥",desc:"ç‚¹äº®ç«æŠŠå³å¯é€šå…³ã€‚",music:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
    setup(el){el.innerHTML=`<div id="torch">ğŸªµ</div>`;setResult("");},
    run(el){el.innerHTML=`ğŸ”¥ğŸªµ`;setResult("âœ… é€šå…³",true);saveProgress("L1");},
    reset(el){el.innerHTML=`<div id="torch">ğŸªµ</div>`;setResult("");}},
  L2:{title:"L2 ç§»åŠ¨å°çƒ âš½",desc:"å°çƒç§»åŠ¨åˆ°ç»ˆç‚¹å³å¯é€šå…³ã€‚",music:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3",
    setup(el){el.innerHTML=`<div id="ball">âš½</div>`;el.dataset.pos=0;setResult("");},
    run(el){el.dataset.pos=+el.dataset.pos+5;if(el.dataset.pos>=5){setResult("âœ… å°çƒåˆ°ç»ˆç‚¹ï¼",true);saveProgress("L2");}else setResult("ç»§ç»­ç§»åŠ¨â€¦");},
    reset(el){el.dataset.pos=0;el.innerHTML=`<div id="ball">âš½</div>`;setResult("");}},
  L3:{title:"L3 å¼€é—¨è¯•ç‚¼ ğŸšª",desc:"è·å¾—é’¥åŒ™å¹¶æ‰“å¼€å¤§é—¨ã€‚",music:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3",
    setup(el){el.innerHTML=`<div id="door">ğŸšª</div>`;setResult("");},
    run(el){el.innerHTML=`ğŸšªğŸ”‘ â†’ å¼€é—¨`;setResult("âœ… å¤§é—¨å·²å¼€ï¼",true);saveProgress("L3");},
    reset(el){el.innerHTML=`<div id="door">ğŸšª</div>`;setResult("");}},
  L4:{title:"L4 é©¯æœå°æ€ªå…½ ğŸ¾",desc:"å–‚é£Ÿæ€ªå…½ï¼Œæ€ªå…½å†·é™ä¸‹æ¥ã€‚",music:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3",
    setup(el){el.innerHTML=`ğŸ‘¾`;setResult("");},
    run(el){el.innerHTML=`ğŸ‘¾ğŸ â†’ ğŸ˜Š`;setResult("âœ… æ€ªå…½å†·é™ï¼",true);saveProgress("L4");},
    reset(el){el.innerHTML=`ğŸ‘¾`;setResult("");}},
  L5:{title:"L5 ç¯å¡”å¼•èˆª â›µ",desc:"èµ°åˆ°ç»ˆç‚¹å³é€šå…³ã€‚",music:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3",
    setup(el){el.innerHTML=`â›µ`;setResult("");},
    run(el){el.innerHTML=`â›µ â†’ ç»ˆç‚¹`;setResult("âœ… åˆ°è¾¾èˆªç‚¹ï¼",true);saveProgress("L5");},
    reset(el){el.innerHTML=`â›µ`;setResult("");}},
  L6:{title:"L6 å®ç®±å¯†ç  ğŸ’",desc:"è¾“å…¥æ­£ç¡®å¯†ç ï¼ˆ1234ï¼‰ã€‚",music:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3",
    setup(el){el.innerHTML=`ğŸ§°`;setResult("");},
    run(el){const pwd=prompt("è¯·è¾“å…¥å¯†ç ","");if(pwd==="1234"){el.innerHTML=`ğŸ’`;setResult("âœ… å®ç®±å¼€å¯ï¼",true);saveProgress("L6");}else setResult("âŒ å¯†ç é”™è¯¯");},
    reset(el){el.innerHTML=`ğŸ§°`;setResult("");}},
  L7:{title:"L7 æ€ªå…½å›¾é‰´ ğŸ“–",desc:"å›¾é‰´å®Œæˆå³å¯é€šå…³ã€‚",music:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-7.mp3",
    setup(el){el.innerHTML=`ğŸ“–`;setResult("");},
    run(el){el.innerHTML=`ğŸ² å›¾é‰´å®Œæˆ`;setResult("âœ… é€šå…³ï¼",true);saveProgress("L7");},
    reset(el){el.innerHTML=`ğŸ“–`;setResult("");}},
  L8:{title:"L8 ç¥ç§˜çŸ³ç¢‘ ğŸ—¿",desc:"æ¿€æ´»æŒ‰é’®å³å¯é€šå…³ã€‚",music:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3",
    setup(el){el.innerHTML=`ğŸ—¿`;setResult("");},
    run(el){el.innerHTML=`ğŸ—¿âœ¨`;setResult("âœ… çŸ³ç¢‘æ¿€æ´»ï¼",true);saveProgress("L8");},
    reset(el){el.innerHTML=`ğŸ—¿`;setResult("");}},
  L9:{title:"L9 é­”æ³•å·è½´ ğŸ“œ",desc:"é‡Šæ”¾å’’è¯­å³å¯é€šå…³ã€‚",music:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-9.mp3",
    setup(el){el.innerHTML=`ğŸ“œ`;setResult("");},
    run(el){el.innerHTML=`ğŸ“œâœ¨`;setResult("âœ… é­”æ³•é‡Šæ”¾ï¼",true);saveProgress("L9");},
    reset(el){el.innerHTML=`ğŸ“œ`;setResult("");}},
  L10:{title:"L10 ç»ˆæè¯•ç‚¼ ğŸ‘‘",desc:"å®Œæˆæœ€ç»ˆè¯•ç‚¼å³å¯é€šå…³ã€‚",music:"https://www.soundhelix.com/examples/mp3/SoundHelix-Song-10.mp3",
    setup(el){el.innerHTML=`ğŸ‰ Boss`;setResult("");},
    run(el){el.innerHTML=`ğŸ‰âš”ï¸ â†’ âœ…`;setResult("âœ… æœ€ç»ˆè¯•ç‚¼é€šè¿‡ï¼",true);saveProgress("L10");},
    reset(el){el.innerHTML=`ğŸ‰ Boss`;setResult("");}}
};

/* ===== èœå•ä¸äº¤äº’ ===== */
const menu=document.getElementById("menu");
Object.entries(LEVELS).forEach(([id,lv])=>{
  const d=document.createElement("div");
  d.className="lvl"; d.textContent=lv.title; d.id="btn-"+id;
  d.onclick=()=>openLevel(id);
  menu.appendChild(d);
});

function openLevel(id){
  current=id;
  [...menu.children].forEach(x=>x.classList.remove("active"));
  document.getElementById("btn-"+id).classList.add("active");
  hint.textContent=LEVELS[id].title;
  desc.textContent=LEVELS[id].desc;
  LEVELS[id].setup(scene);
  playMusic(LEVELS[id].music);
  nextBtn.classList.remove("show");
}

document.getElementById("run").onclick=()=>{ if(current) LEVELS[current].run(scene); };
document.getElementById("reset").onclick=()=>{ if(current) LEVELS[current].reset(scene); };
nextBtn.onclick=()=>{
  if(!current) return;
  const ids=Object.keys(LEVELS);
  const idx=ids.indexOf(current);
  if(idx>=0 && idx<ids.length-1) openLevel(ids[idx+1]);
  else setResult("ğŸ‰ å…¨éƒ¨é€šå…³ï¼", false);
};

// æ¸…ç©ºè¿›åº¦
document.getElementById("resetProgress").onclick=()=>{
  if(confirm("ç¡®å®šè¦æ¸…ç©ºé€šå…³è¿›åº¦å—ï¼Ÿ")){
    localStorage.removeItem("passedLevels");
    alert("è¿›åº¦å·²æ¸…ç©ºï¼Œè¿”å›é¦–é¡µå¯çœ‹åˆ° 0/10ã€‚");
  }
};

// é»˜è®¤è¿›å…¥ L1
openLevel("L1");
</script>
</body>
</html>
